#### 容器与镜像

+ 普通的系统应用

  + 通常一个应用就是一个进程，在 linux 操作系统中，通过 ps 命令即可以查看各个进程。进程之间具备如下特点：
    1. 进程之间可见，可相互通信
    2. 共享同一份文件系统
  + 具备的问题：
    1. 由于进程之间可见可相互通信，则意味着具有高级权限的进程可以攻击其他进程。**【？】**
    2. 由于共享同一份文件系统，使得具有高级权限的进程可以把其他应用所需要的进程（数据）删除，破坏其他进程的运行。
    3. 由于共享同一份文件系统，进程之间所需要的依赖（数据）可能存在冲突，给运维带来一定的压力。**【？】**
    4. 由于共享同一份文件系统，应用之间存在资源的抢占问题：当一个应用占用过多的 CPU、内存时，其他应用无法正常运行。

+ Linux、UNIX 操作系统提供了 chroot、namespace、cgroup 三个系统调用解决了上述问题。

  + [chroot （change root 系统调用）](https://www.cnblogs.com/busui/p/6891549.html)：将进程所在的子目录变成进程的**逻辑根目录**。即：进程在 chroot 的帮助下，拥有了一个独立的文件系统。

    ```txt
    在 unix/类unix操作系统上，默认的系统根目录是 "/"，而 chroot 系统调用可以为进程创建 “逻辑根目录”，即：将进程所在的目录变成该进程的“逻辑根目录”。
    若修改了进程的根目录，便不能访问“逻辑根目录”以外的文件。本质上，这限制了该进程所能进入的目录树。因此，也成为 chroot jail（chroot 监狱）。
    因此，该进程的任何操作都不会影响到其他进程的使用。
    ```

  + namespace 系统调用：实现进程隔离，即：在资源的视图上进行隔离。

    ```txt
    Linux Namespace 提供了一种内核级别隔离系统资源的方法，通过将系统的全局资源放在不同的 NameSpace 中，是按资源隔离的目的。
    不同 Namespace 的程序可以享有一份独立的系统资源。
    
    在 chroot、namespace 系统调用下，进程便能运行在独立的环境中。
    ```

    [浅谈 Linux Namespace 机制](https://zhuanlan.zhihu.com/p/73248894) | [Linux Namespace 详解](https://cloud.tencent.com/developer/article/1583922)

  + [cgroup 系统调用](https://tech.meituan.com/2015/03/31/cgroups.html)：限制资源使用率。

    ```txt
    cgroups 是 Linux 内核提供的一种可以限制单个或多个进程使用资源的机制。可以对 CPU、内存 等资源实现精细化控制。
    
    例如：该进程只能使用 2G 内存，只能使用 2 个 CPU
    ```

+ 容器：

  + 容器是一个视图隔离、资源可限制、具有独立文件系统的进程集合。

    + 视图隔离：如，能看见 其他/部分 进程；拥有独立主机名 等。
    + 控制资源使用率：如，内存使用大小；CPU 使用个数 等。

  + 拥有独立文件系统的优势：

    由于使用的是系统上的资源，因此，独立的文件系统中不需要具备内核相关的代码/工具，而只需要提供该容器所需的 二进制配置文件或者依赖 即可，只要容器运行时所需要的文件集合它都具备了，那么该容器就能够运行起来



#### 容器生命周期

#### 容器项目的架构

#### 容器 vs VM

#### 课后习题