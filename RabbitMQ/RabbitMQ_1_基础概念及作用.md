#### 【RabbitMQ_1_基础概念及作用】

1. 什么是 RabbitMQ

   MQ 消息队列是一种消息中间件，是应用程序对应用程序的通信的方法。应用程序通过读入写出队列的消息进行消息通信，而无需在应用程序之间提供专用的连接也无需直接调用对方接口进行通信（MQ是一种短连接）。

2. 安装环境

   详见：[ material/rabbitmq-3.5.1-安装.txt ]

3. RabbitMQ 用途

   + 同步 -> 异步

     ```xml
     <!--同步-->
     用户下订单，通过订单服务器，需要先后完成 短信服务、E-mail服务、App-push服务，每个服务都需要耗时，并且只有上述任务完成以后，才能够响应给用户：用户体验：耗时、慢！
     ```

     <img src="material\1_同步.png"  />

     ```xml
     <!-- 同步 =》 异步 -->
     【方式1】：使用线程池，实现伪异步
     	通过线程变成异步！
       	需要手动实现线程池，各个服务之间依旧是强耦合！
     ```

     ![](material\2_异步_线程池（伪异步）.png)

     ```xml
     <!-- 同步 =》 异步 -->
     【方式2 】：使用消息队列：RabbitMQ
     	在订单系统以外，再加一个MQ系统，订单系统将用户的订单处理下发给消息队列，然后直接返回处理状态，剩下的工作由消息队列再MQ系统中调用各个服务平台的接口发起请求，此时已经和订单服务没有关系了，因为 MQ系统事独立出来的系统，这样可以大大降低用户创建订单的耗时，同时实现订单服务与其他服务的耦合！
     ```

     <img src="material\3_异步_消息队列MQ.png" style="zoom" />

   + 解耦

     ```xml
     <!-- 解耦 -->
     通过MQ系统，解除了订单系统与其他系统之间的耦合度，订单系统不需要调用其他服务平台的接口，订单系统将消息直接传递给MQ系统，其他服务则从MQ系统中订阅消息
     ```

     ![](material\4_解耦.png)

   + 削峰

     ```xml
     <!-- 流量削峰 -->
     消息队列能解决大流量的流量削峰，例如秒杀服务的应用。
     将瞬间的大并发请求交给消息队列，防止服务器瞬间瘫痪的情况，消息中间件只会接收和发送消息，而不会处理消息，最终的消息处理还是需要调用服务平台的API处理。
     可以为消息队列设置一个阈值，当接收到的消息达到设定的阈值后，就不再接收消息！而对于这些被拒收的请求，可以将其跳转到一个提示页面：活动已结束、当前系统正忙等，给客户端一个响应！
     ```

     ![](material\5_削峰.png)

4. 基础知识

   + Provider：消息生产者：提供消息的程序

   + Consumer：消息消费者：接收消息的程序

   + 当不使用消息队列时，Provider与Consumer紧耦合，使用了消息队列之后，消息的传递就会通过消息队列，将生产者消息转发到消费者，而生产者与消费者之间松耦合！ `【高度耦合的缺点！】`

     ![两种消息投递模型](material\6_消息投递模型.png)

   + 队列：rabbitMQ中储存信息流，相当于一个无限制的缓冲区！

   + 多个生产者可以将消息发送到同一个队列中，多个消费者也可以只从一个消息队列中接收消息！
